// مكتبة الأسئلة السقراطية التوجيهية لمرجان
// Socratic Questions Library for Marjan Virtual Teacher

export interface SocraticQuestionSet {
  concept: string;
  subject: string;
  difficulty: 'basic' | 'intermediate' | 'advanced';
  guidingQuestions: string[];
  analogies: string[];
  realWorldExamples: string[];
  commonMisconceptions: string[];
  visualAids: string[];
}

export interface ConceptMapping {
  [key: string]: SocraticQuestionSet;
}

// بنك الأسئلة السقراطية للرياضيات
export const MATHEMATICS_CONCEPTS: ConceptMapping = {
  fractions: {
    concept: "الكسور",
    subject: "mathematics",
    difficulty: "basic",
    guidingQuestions: [
      "لو كان لديك بيتزا وأردت تقسيمها بينك وبين أخيك، كيف ستقسمها؟",
      "إذا أكلت نصف التفاحة، كم تبقى منها؟",
      "ماذا يعني أن نقول 'ربع الساعة'؟",
      "لو كان لديك 4 قطع حلوى وأعطيت صديقك قطعة واحدة، أي جزء أعطيته؟",
      "كيف يمكنك تمثيل النصف بالأرقام؟"
    ],
    analogies: [
      "الكسر مثل قطعة من الكعكة - الرقم السفلي يخبرنا كم قطعة قُسمت الكعكة إليها، والرقم العلوي يخبرنا كم قطعة أخذنا",
      "فكر في الكسر كعنوان منزل - الرقم العلوي هو رقم المنزل، والرقم السفلي هو رقم الشارع",
      "الكسر مثل تقسيم المال - لو كان معك 10 ريالات وقسمتها على 5 أشخاص، كل شخص يأخذ 2 ريال"
    ],
    realWorldExamples: [
      "عندما نقول 'نصف كوب من الدقيق' في الطبخ",
      "عندما نقول 'ربع ساعة' للوقت",
      "عندما نقسم الفاتورة في المطعم على عدد الأشخاص",
      "عندما نقول 'ثلث الطريق' في السفر"
    ],
    commonMisconceptions: [
      "الاعتقاد أن الكسر الأكبر هو الذي له رقم أكبر في الأسفل",
      "عدم فهم أن 1/2 = 2/4 = 3/6",
      "الخلط بين جمع الكسور وضربها"
    ],
    visualAids: [
      "رسم دوائر مقسمة إلى أجزاء",
      "رسم مستطيلات مظللة",
      "استخدام قطع الفاكهة أو البيتزا"
    ]
  },

  pythagoras: {
    concept: "نظرية فيثاغورس",
    subject: "mathematics",
    difficulty: "intermediate",
    guidingQuestions: [
      "إذا كان لديك مثلث قائم الزاوية، أي ضلع تعتقد أنه الأطول؟",
      "لماذا تعتقد أن الضلع المقابل للزاوية القائمة هو الأطول؟",
      "لو كان لديك سلم مائل على الحائط، كيف تحسب طول السلم؟",
      "ما العلاقة بين أضلاع المثلث القائم الزاوية؟",
      "كيف يمكن أن نتأكد من أن المثلث قائم الزاوية؟"
    ],
    analogies: [
      "فكر في المثلث القائم كزاوية غرفة - الحائطان هما الضلعان القائمان، والقطر هو الوتر",
      "مثل سلم مائل على الحائط - المسافة من الحائط والارتفاع والسلم نفسه",
      "كالمشي في المدينة - يمكنك المشي شرقاً ثم شمالاً، أو المشي مباشرة قطرياً"
    ],
    realWorldExamples: [
      "حساب طول السلم المطلوب للوصول لنافذة في الطابق الثاني",
      "تحديد المسافة المباشرة بين نقطتين على الخريطة",
      "حساب قطر شاشة التلفزيون من العرض والارتفاع"
    ],
    commonMisconceptions: [
      "الاعتقاد أن النظرية تعمل مع جميع المثلثات",
      "الخلط بين الوتر والأضلاع الأخرى",
      "عدم فهم أن النظرية تتطلب تربيع الأطوال"
    ],
    visualAids: [
      "رسم مثلث قائم الزاوية مع تسمية الأضلاع",
      "رسم مربعات على كل ضلع لتوضيح التربيع",
      "استخدام شبكة مربعات لحساب المساحات"
    ]
  }
};

// بنك الأسئلة السقراطية للفيزياء
export const PHYSICS_CONCEPTS: ConceptMapping = {
  ohms_law: {
    concept: "قانون أوم",
    subject: "physics",
    difficulty: "intermediate",
    guidingQuestions: [
      "لو كان لديك مصباح وزدت قوة البطارية، ماذا تتوقع أن يحدث لإضاءة المصباح؟",
      "إذا كانت الإضاءة الأقوى تعني تياراً أكبر، ما العلاقة بين قوة البطارية والتيار؟",
      "ماذا لو أضفنا مقاومة أكبر للدائرة؟ كيف سيؤثر ذلك على التيار؟",
      "لماذا تحتاج الأجهزة القوية لكابلات أسمك؟",
      "كيف يمكن أن نتحكم في شدة الإضاءة؟"
    ],
    analogies: [
      "فكر في الكهرباء كالماء في الأنابيب - الجهد مثل ضغط الماء، والتيار مثل كمية الماء المتدفقة، والمقاومة مثل ضيق الأنبوب",
      "مثل الطريق السريع - الجهد كالسرعة المسموحة، والتيار كعدد السيارات، والمقاومة كالازدحام",
      "كالنهر - الجهد كانحدار النهر، والتيار كسرعة الماء، والمقاومة كالصخور في النهر"
    ],
    realWorldExamples: [
      "عندما تخفت إضاءة المصباح في البيت بسبب انخفاض الجهد",
      "لماذا تسخن الأسلاك عند مرور تيار كبير",
      "كيف يعمل منظم الإضاءة (الديمر) في المنزل"
    ],
    commonMisconceptions: [
      "الاعتقاد أن المقاومة تنتج الكهرباء",
      "عدم فهم الفرق بين الجهد والتيار",
      "الاعتقاد أن زيادة المقاومة تزيد التيار"
    ],
    visualAids: [
      "رسم دائرة كهربائية بسيطة",
      "رسم مخطط يوضح العلاقة بين V, I, R",
      "استخدام ألوان مختلفة للجهد والتيار والمقاومة"
    ]
  },

  gravity: {
    concept: "الجاذبية",
    subject: "physics",
    difficulty: "basic",
    guidingQuestions: [
      "لماذا تسقط التفاحة لأسفل وليس لأعلى؟",
      "ماذا يحدث عندما تقفز في الهواء؟",
      "لماذا لا تطير الأشياء في الهواء؟",
      "هل تعتقد أن الجاذبية تؤثر على جميع الأشياء بنفس الطريقة؟",
      "لماذا يسقط الحجر أسرع من الريشة في الهواء؟"
    ],
    analogies: [
      "الجاذبية مثل مغناطيس خفي يجذب كل شيء نحو الأرض",
      "مثل يد خفية تسحب الأشياء لأسفل باستمرار",
      "كالمصعد الذي ينزل - كل شيء يتحرك نحو الأسفل"
    ],
    realWorldExamples: [
      "سقوط المطر من السحب",
      "تدحرج الكرة من أعلى التل",
      "سقوط الأوراق من الشجر في الخريف"
    ],
    commonMisconceptions: [
      "الاعتقاد أن الأشياء الثقيلة تسقط أسرع دائماً",
      "عدم فهم أن الجاذبية تعمل في الفضاء أيضاً",
      "الاعتقاد أن الجاذبية تحتاج هواء لتعمل"
    ],
    visualAids: [
      "رسم الأرض مع أسهم تشير نحو المركز",
      "رسم أشياء مختلفة تسقط",
      "مخطط يوضح مسار الأجسام الساقطة"
    ]
  }
};

// بنك الأسئلة السقراطية للكيمياء
export const CHEMISTRY_CONCEPTS: ConceptMapping = {
  chemical_reactions: {
    concept: "التفاعلات الكيميائية",
    subject: "chemistry",
    difficulty: "intermediate",
    guidingQuestions: [
      "ماذا يحدث عندما نخلط الخل مع بيكربونات الصوديوم؟",
      "لماذا تعتقد أن هذا التفاعل ينتج فقاعات؟",
      "هل يمكنك التفكير في تفاعلات أخرى تراها في المطبخ؟",
      "ما الذي يجعل الحديد يصدأ؟",
      "كيف يمكننا معرفة أن تفاعلاً كيميائياً قد حدث؟"
    ],
    analogies: [
      "التفاعل الكيميائي مثل الطبخ - نخلط مكونات مختلفة لنحصل على طبق جديد",
      "مثل الرقص - الذرات تتحرك وتغير شركاءها لتكوين مركبات جديدة",
      "كالزواج - ذرات مختلفة تتحد لتكوين عائلة جديدة (مركب)"
    ],
    realWorldExamples: [
      "احتراق الشمعة",
      "هضم الطعام في المعدة",
      "صدأ الحديد",
      "تخمر العجين",
      "تفاعل الأدوية في الجسم"
    ],
    commonMisconceptions: [
      "الاعتقاد أن التفاعل يدمر المادة",
      "عدم فهم أن الكتلة محفوظة في التفاعل",
      "الخلط بين التغير الفيزيائي والكيميائي"
    ],
    visualAids: [
      "رسم الجزيئات قبل وبعد التفاعل",
      "مخطط يوضح كسر وتكوين الروابط",
      "تمثيل بالكرات والعصي للجزيئات"
    ]
  },

  periodic_table: {
    concept: "الجدول الدوري",
    subject: "chemistry",
    difficulty: "intermediate",
    guidingQuestions: [
      "لماذا تعتقد أن العناصر مرتبة بهذا الشكل في الجدول؟",
      "ما القاسم المشترك بين العناصر في نفس العمود؟",
      "لماذا الهيدروجين في أعلى الجدول؟",
      "كيف يمكن للجدول أن يساعدنا في التنبؤ بخصائص العناصر؟",
      "ما الفرق بين الصف والعمود في الجدول؟"
    ],
    analogies: [
      "الجدول الدوري مثل عمارة سكنية - كل طابق (دورة) له خصائص مشتركة",
      "مثل تنظيم المكتبة - الكتب المتشابهة في نفس الرف",
      "كالعائلة الكبيرة - أفراد العائلة الواحدة (المجموعة) لهم صفات متشابهة"
    ],
    realWorldExamples: [
      "الذهب والفضة في نفس المجموعة لأنهما معادن نبيلة",
      "الصوديوم والبوتاسيوم يتفاعلان مع الماء بعنف",
      "الهيليوم والنيون غازات خاملة"
    ],
    commonMisconceptions: [
      "الاعتقاد أن الترتيب عشوائي",
      "عدم فهم الفرق بين الدورة والمجموعة",
      "الخلط بين العدد الذري والكتلة الذرية"
    ],
    visualAids: [
      "رسم الجدول الدوري مع تلوين المجموعات",
      "مخطط يوضح التدرج في الخصائص",
      "نماذج ثلاثية الأبعاد للذرات"
    ]
  }
};

// بنك الأسئلة السقراطية للأحياء
export const BIOLOGY_CONCEPTS: ConceptMapping = {
  photosynthesis: {
    concept: "البناء الضوئي",
    subject: "biology",
    difficulty: "intermediate",
    guidingQuestions: [
      "لماذا تعتقد أن النباتات خضراء اللون؟",
      "ماذا تحتاج النباتات لتنمو؟",
      "من أين تحصل النباتات على طعامها؟",
      "لماذا تموت النباتات في الظلام؟",
      "ما العلاقة بين النباتات والأكسجين الذي نتنفسه؟"
    ],
    analogies: [
      "البناء الضوئي مثل مطبخ النبات - يحول المواد الخام إلى طعام",
      "مثل الألواح الشمسية - تحول ضوء الشمس إلى طاقة",
      "كالمصنع - يدخل مواد خام ويخرج منتجات مفيدة"
    ],
    realWorldExamples: [
      "اخضرار الأوراق في الربيع",
      "نمو النباتات نحو النافذة",
      "ذبول النباتات في الظلام",
      "إنتاج الأكسجين في الغابات"
    ],
    commonMisconceptions: [
      "الاعتقاد أن النباتات تأكل من التربة",
      "عدم فهم دور ثاني أكسيد الكربون",
      "الخلط بين التنفس والبناء الضوئي"
    ],
    visualAids: [
      "رسم مقطع عرضي للورقة",
      "مخطط يوضح دخول وخروج الغازات",
      "رسم الكلوروفيل والكلوروبلاست"
    ]
  },

  cell_structure: {
    concept: "تركيب الخلية",
    subject: "biology",
    difficulty: "basic",
    guidingQuestions: [
      "إذا كان جسمك مبني من قطع صغيرة، ما أصغر قطعة تتخيلها؟",
      "كيف تعتقد أن هذه القطع الصغيرة تعمل معاً؟",
      "ما الذي يحمي هذه القطع الصغيرة من الخارج؟",
      "أين تعتقد أن 'دماغ' هذه القطعة الصغيرة؟",
      "كيف تحصل هذه القطع على الطاقة للعمل؟"
    ],
    analogies: [
      "الخلية مثل المنزل - لها جدران وغرف مختلفة لوظائف مختلفة",
      "مثل المصنع - كل قسم له وظيفة محددة",
      "كالمدينة الصغيرة - فيها مركز قيادة ومحطة طاقة ومخازن"
    ],
    realWorldExamples: [
      "خلايا الجلد التي تتجدد",
      "خلايا الدم الحمراء التي تنقل الأكسجين",
      "خلايا العضلات التي تتحرك"
    ],
    commonMisconceptions: [
      "الاعتقاد أن جميع الخلايا متشابهة",
      "عدم فهم أن الخلايا حية",
      "الخلط بين الخلية والذرة"
    ],
    visualAids: [
      "رسم الخلية النباتية والحيوانية",
      "مخطط يوضح العضيات ووظائفها",
      "مقارنة بين أنواع الخلايا المختلفة"
    ]
  }
};

// بنك الأسئلة السقراطية للبرمجة
export const PROGRAMMING_CONCEPTS: ConceptMapping = {
  variables: {
    concept: "المتغيرات",
    subject: "programming",
    difficulty: "basic",
    guidingQuestions: [
      "لو أردت أن تتذكر اسم صديقك، أين ستكتبه؟",
      "كيف تحتفظ بالمعلومات المهمة في حياتك اليومية؟",
      "ماذا لو أردت تغيير اسم صديقك المحفوظ؟",
      "كيف تنظم أغراضك في المنزل؟ هل تضع كل شيء في مكان محدد؟",
      "ما الفرق بين صندوق مكتوب عليه 'كتب' وصندوق مكتوب عليه 'ملابس'؟"
    ],
    analogies: [
      "المتغير مثل صندوق له اسم - يمكنك وضع شيء بداخله وتغييره لاحقاً",
      "مثل جيب في ملابسك - له اسم (جيب القميص) ويمكنك وضع أشياء مختلفة فيه",
      "كالملصق على البرطمان - الملصق هو اسم المتغير والمحتوى هو القيمة"
    ],
    realWorldExamples: [
      "حفظ رقم هاتف صديق في الهاتف تحت اسمه",
      "كتابة قائمة التسوق وتعديلها حسب الحاجة",
      "حفظ المال في محفظة مكتوب عليها 'مصروف الجيب'"
    ],
    commonMisconceptions: [
      "الاعتقاد أن المتغير والقيمة شيء واحد",
      "عدم فهم أن المتغير يمكن أن يحتوي قيماً مختلفة",
      "الخلط بين اسم المتغير وقيمته"
    ],
    visualAids: [
      "رسم صناديق بأسماء مختلفة",
      "مخطط يوضح المتغير كحاوية",
      "جدول يوضح أسماء المتغيرات وقيمها"
    ]
  },

  loops: {
    concept: "الحلقات التكرارية",
    subject: "programming",
    difficulty: "intermediate",
    guidingQuestions: [
      "كيف تغسل أسنانك كل يوم؟ هل تكرر نفس الخطوات؟",
      "ماذا لو أردت أن تعد من 1 إلى 100؟ هل ستكتب كل رقم بشكل منفصل؟",
      "كيف تقوم بطي الملابس؟ هل تكرر نفس العملية لكل قطعة؟",
      "ما الذي يجعلك تتوقف عن العد؟",
      "كيف يمكن للكمبيوتر أن يعرف متى يتوقف عن التكرار؟"
    ],
    analogies: [
      "الحلقة مثل أغنية مكررة - تعيد نفس اللحن حتى تقرر إيقافها",
      "مثل المشي في دائرة - تكرر نفس المسار حتى تقرر الخروج",
      "كالغسالة - تكرر دورة الغسيل حتى تنتهي من البرنامج المحدد"
    ],
    realWorldExamples: [
      "عد الأغنام للنوم",
      "تكرار التمارين الرياضية",
      "قراءة صفحات الكتاب واحدة تلو الأخرى"
    ],
    commonMisconceptions: [
      "عدم فهم أهمية شرط التوقف",
      "الاعتقاد أن الحلقة تعمل إلى ما لا نهاية",
      "الخلط بين أنواع الحلقات المختلفة"
    ],
    visualAids: [
      "رسم دائرة مع أسهم تشير للتكرار",
      "مخطط تدفق يوضح الحلقة",
      "جدول يوضح قيم المتغير في كل تكرار"
    ]
  },

  functions: {
    concept: "الدوال",
    subject: "programming",
    difficulty: "intermediate",
    guidingQuestions: [
      "لو أردت أن تعلم صديقك كيف يصنع الشاي، هل ستكرر نفس التعليمات كل مرة؟",
      "كيف يمكنك تنظيم التعليمات بحيث تستخدمها مرة واحدة وتطبقها عدة مرات؟",
      "ماذا لو أردت تغيير نوع الشاي؟ هل ستغير كل التعليمات؟",
      "كيف تتعامل مع الوصفات في الطبخ؟",
      "ما الفائدة من تقسيم المهام الكبيرة إلى مهام صغيرة؟"
    ],
    analogies: [
      "الدالة مثل وصفة الطبخ - تعطيها مكونات وتعيد لك طبقاً جاهزاً",
      "مثل آلة القهوة - تضع القهوة والماء وتحصل على قهوة جاهزة",
      "كالعامل المتخصص - تعطيه مواد خام ويعيد لك منتجاً مصنعاً"
    ],
    realWorldExamples: [
      "حاسبة الهاتف - تعطيها أرقام وتعيد النتيجة",
      "ماكينة الصراف - تعطيها رقم سري وتعيد المال",
      "محرك البحث - تعطيه كلمات وتعيد النتائج"
    ],
    commonMisconceptions: [
      "الاعتقاد أن الدالة تعمل مرة واحدة فقط",
      "عدم فهم الفرق بين المعاملات والمتغيرات",
      "الخلط بين استدعاء الدالة وتعريفها"
    ],
    visualAids: [
      "رسم صندوق يدخل إليه شيء ويخرج منه شيء آخر",
      "مخطط يوضح تدفق البيانات في الدالة",
      "مثال بصري لاستدعاء الدالة عدة مرات"
    ]
  },

  algorithms: {
    concept: "الخوارزميات",
    subject: "programming",
    difficulty: "advanced",
    guidingQuestions: [
      "كيف تجد كتاباً معيناً في مكتبة كبيرة؟",
      "ما الطريقة الأسرع للوصول من بيتك للمدرسة؟",
      "كيف تنظم أوراقك بحيث تجد ما تريد بسرعة؟",
      "لو كان لديك قائمة أسماء طويلة، كيف ترتبها أبجدياً؟",
      "ما الفرق بين الطريقة السريعة والطريقة الصحيحة؟"
    ],
    analogies: [
      "الخوارزمية مثل خريطة الطريق - تخبرك بالخطوات للوصول للهدف",
      "مثل تعليمات تجميع الأثاث - خطوات واضحة ومرتبة",
      "كالوصفة الطبية - خطوات محددة للحصول على النتيجة المطلوبة"
    ],
    realWorldExamples: [
      "خوارزمية البحث في Google",
      "نظام التوصيل في تطبيقات الطعام",
      "ترتيب المنشورات في وسائل التواصل",
      "نظام التوصيات في Netflix"
    ],
    commonMisconceptions: [
      "الاعتقاد أن الخوارزمية معقدة دائماً",
      "عدم فهم أهمية الكفاءة",
      "الخلط بين الخوارزمية والبرنامج"
    ],
    visualAids: [
      "مخطط تدفق للخوارزمية",
      "مقارنة بين خوارزميات مختلفة",
      "رسم بياني لأداء الخوارزميات"
    ]
  }
};

// دالة للحصول على أسئلة سقراطية حسب المفهوم
export function getSocraticQuestions(
  concept: string, 
  subject: string = 'general',
  difficulty: 'basic' | 'intermediate' | 'advanced' = 'basic'
): SocraticQuestionSet | null {
  
  // البحث في المفاهيم حسب المادة
  const conceptMappings = {
    mathematics: MATHEMATICS_CONCEPTS,
    physics: PHYSICS_CONCEPTS,
    chemistry: CHEMISTRY_CONCEPTS,
    biology: BIOLOGY_CONCEPTS,
    programming: PROGRAMMING_CONCEPTS
  };
  
  const subjectConcepts = conceptMappings[subject as keyof typeof conceptMappings];
  if (subjectConcepts && subjectConcepts[concept]) {
    return subjectConcepts[concept];
  }
  
  // البحث في جميع المفاهيم
  for (const mapping of Object.values(conceptMappings)) {
    if (mapping[concept]) {
      return mapping[concept];
    }
  }
  
  return null;
}

// دالة لتوليد أسئلة سقراطية عامة
export function generateGenericSocraticQuestions(topic: string): string[] {
  return [
    `ما الذي تعرفه بالفعل عن ${topic}؟`,
    `هل يمكنك إعطائي مثالاً من الحياة اليومية عن ${topic}؟`,
    `لماذا تعتقد أن ${topic} مهم؟`,
    `كيف تعتقد أن ${topic} يعمل؟`,
    `ما الذي يثير فضولك حول ${topic}؟`
  ];
}

// دالة للحصول على تشبيه مناسب
export function getAnalogy(concept: string, subject: string): string | null {
  const questionSet = getSocraticQuestions(concept, subject);
  if (questionSet && questionSet.analogies.length > 0) {
    return questionSet.analogies[Math.floor(Math.random() * questionSet.analogies.length)];
  }
  return null;
}

// دالة للحصول على مثال من الحياة الواقعية
export function getRealWorldExample(concept: string, subject: string): string | null {
  const questionSet = getSocraticQuestions(concept, subject);
  if (questionSet && questionSet.realWorldExamples.length > 0) {
    return questionSet.realWorldExamples[Math.floor(Math.random() * questionSet.realWorldExamples.length)];
  }
  return null;
}

// دالة للحصول على سؤال توجيهي عشوائي
export function getRandomGuidingQuestion(concept: string, subject: string): string | null {
  const questionSet = getSocraticQuestions(concept, subject);
  if (questionSet && questionSet.guidingQuestions.length > 0) {
    return questionSet.guidingQuestions[Math.floor(Math.random() * questionSet.guidingQuestions.length)];
  }
  return null;
}
